import { useState } from "react";

const getWeekends = () => {
  let weekends = [];
  let start = new Date("2024-05-01");
  let end = new Date("2024-09-30");

  while (start <= end) {
    if (start.getDay() === 5) {
      let saturday = new Date(start);
      saturday.setDate(saturday.getDate() + 1);
      let sunday = new Date(start);
      sunday.setDate(sunday.getDate() + 2);
      weekends.push({
        id: `${start.toISOString().slice(0, 10)}`,
        label: `${start.toLocaleDateString()} - ${sunday.toLocaleDateString()}`,
        votes: [],
      });
    }
    start.setDate(start.getDate() + 1);
  }

  return weekends;
};

export default function VoteWeekends() {
  const [name, setName] = useState("");
  const [weekends, setWeekends] = useState(getWeekends());

  const handleVote = (id) => {
    if (!name) return alert("Vyplňte své jméno před hlasováním!");
    setWeekends((prev) =>
      prev.map((weekend) =>
        weekend.id === id && !weekend.votes.includes(name)
          ? { ...weekend, votes: [...weekend.votes, name] }
          : weekend
      )
    );
  };

  return (
    <div style={{ padding: "20px", maxWidth: "600px", margin: "auto" }}>
      <h1 style={{ fontSize: "24px", fontWeight: "bold" }}>Hlasování o víkendech</h1>
      <input
        style={{ width: "100%", padding: "10px", margin: "10px 0", border: "1px solid #ccc", borderRadius: "5px" }}
        placeholder="Zadejte své jméno"
        value={name}
        onChange={(e) => setName(e.target.value)}
      />
      <div>
        {weekends.map((weekend) => (
          <div key={weekend.id} style={{ border: "1px solid #ddd", padding: "10px", borderRadius: "5px", marginBottom: "10px" }}>
            <p style={{ fontWeight: "bold" }}>{weekend.label}</p>
            <p style={{ fontSize: "14px", color: "gray" }}>
              Hlasovali: {weekend.votes.join(", ") || "Nikdo zatím nehlasoval"}
            </p>
            <button 
              style={{ padding: "10px", backgroundColor: "blue", color: "white", border: "none", borderRadius: "5px", cursor: "pointer" }}
              onClick={() => handleVote(weekend.id)}
            >
              Hlasovat
            </button>
          </div>
        ))}
      </div>
    </div>
  );
}
